import { gray, bold, red, reset, underline } from 'kolorist';
import yargs from 'yargs';
import { hideBin } from 'yargs/helpers';
import { b as build, d as dev } from '../shared/vite-react-ssg.qp2k9AZ2.mjs';
import 'node:module';
import 'node:path';
import 'fs-extra';
import 'jsdom';
import 'p-queue';
import 'vite';
import '../shared/vite-react-ssg.CjIppNIS.mjs';
import '../shared/vite-react-ssg.C6pK7rvr.mjs';
import 'react/jsx-runtime';
import 'react-helmet-async';
import 'node:events';
import 'node:stream';
import '../shared/vite-react-ssg.C0y5wbxl.mjs';
import 'react-dom/server';
import '../shared/vite-react-ssg.B-j07kW6.mjs';

yargs(hideBin(process.argv)).scriptName("vite-react-ssg").usage("$0 [args]").command(
  "build",
  "Build SSG",
  (args) => args.option("script", {
    choices: ["sync", "async", "defer", "async defer"],
    describe: "Rewrites script loading timing"
  }).option("mock", {
    type: "boolean",
    describe: "Mock browser globals (window, document, etc.) for SSG"
  }).option("config", {
    alias: "c",
    type: "string",
    describe: "The vite config file to use"
  }).option("base", {
    alias: "b",
    type: "string",
    describe: "The base path to render"
  }),
  async (args) => {
    const { config: configFile = void 0, ...ssgOptions } = args;
    await build(ssgOptions, { configFile });
  }
).command(
  "dev",
  "Dev SSG",
  (args) => args.option("script", {
    choices: ["sync", "async", "defer", "async defer"],
    describe: "Rewrites script loading timing"
  }).option("mock", {
    type: "boolean",
    describe: "Mock browser globals (window, document, etc.) for SSG"
  }).option("config", {
    alias: "c",
    type: "string",
    describe: "The vite config file to use"
  }).option("base", {
    alias: "b",
    type: "string",
    describe: "The base path to render"
  }).option("host", {
    type: "boolean",
    describe: "The host to expose"
  }),
  async (args) => {
    const { config: configFile = void 0, host, ...ssgOptions } = args;
    await dev(ssgOptions, { configFile, server: { host } });
  }
).fail((msg, err, yargs2) => {
  console.error(`
${gray("[vite-react-ssg]")} ${bold(red("An internal error occurred."))}`);
  console.error(`${gray("[vite-react-ssg]")} ${reset(`Please report an issue, if none already exists: ${underline("https://github.com/daydreamer-riri/vite-react-ssg/issues")}`)}`);
  yargs2.exit(1, err);
}).showHelpOnFail(false).help().argv;
